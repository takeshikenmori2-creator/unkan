<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÈÅãË°åÁÆ°ÁêÜPro 200</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- 200ÂïèÁîüÊàê„É≠„Ç∏„ÉÉ„ÇØ ---
        const generateData = () => {
            const cats = ["Ë≤®Áâ©‰∫ãÊ•≠Ê≥ï", "Ëªä‰∏°Ê≥ï", "ÈÅì‰∫§Ê≥ï", "Âä¥Âü∫Ê≥ï", "ÂÆüÂãô"];
            const years = ["R5", "R4", "R3", "R2", "R1"];
            return Array.from({ length: 200 }, (_, i) => {
                const id = i + 1;
                const cat = cats[i % 5];
                const yr = years[Math.floor(i / 40)];
                let text = `${yr}Âπ¥Â∫¶Ôºö${cat}„ÅÆÈáçË¶Å„Éù„Ç§„É≥„Éà„Å´Èñ¢„Åô„ÇãÂïèÈ°å (No.${id})`;
                let opts = ["Ê≠£„Åó„ÅÑ„ÇÇ„ÅÆ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ", "ÊúüÈñì„ÅÆË™§„ÇäÔºà3Âπ¥„Åß„ÅØ„Å™„Åè1Âπ¥Ôºâ", "‰∏ªË™û„ÅÆË™§„ÇäÔºà‰∫ãÊ•≠ËÄÖ„Åß„ÅØ„Å™„ÅèÈÅãË°åÁÆ°ÁêÜËÄÖÔºâ", "ÊâãÁ∂ö„Åç„ÅÆË™§„ÇäÔºàË™çÂèØ„Åß„ÅØ„Å™„ÅèÂ±äÂá∫Ôºâ"];
                let exp = "Êú¨Áï™È†ªÂá∫„ÄÇÊï∞Â≠óÔºàÊúüÈñìÔºâ„Å®Ë≤¨‰ªª‰∏ª‰Ωì„ÇíÊ≠£Á¢∫„Å´„ÄÇ";

                if (cat === "Âä¥Âü∫Ê≥ï") {
                    text = "„Äê2024ÊîπÊ≠£„ÄëÊñ∞ÊîπÂñÑÂü∫Ê∫ñÂëäÁ§∫„Å´„Åä„Åë„Çã„ÄÅÈÅãËª¢ËÄÖ„ÅÆ1Êó•„ÅÆ‰ºëÊÅØÊúüÈñì„Å®„Åó„Å¶Ê≠£„Åó„ÅÑ„ÇÇ„ÅÆ„ÅØÔºü";
                    opts = ["Á∂ôÁ∂ö11ÊôÇÈñì‰ª•‰∏ä„ÇíÂü∫Êú¨„Å®„Åó„ÄÅ9ÊôÇÈñì„Çí‰∏ãÂõû„Çâ„Å™„ÅÑ", "Á∂ôÁ∂ö8ÊôÇÈñì‰ª•‰∏ä", "Á∂ôÁ∂ö13ÊôÇÈñì‰ª•‰∏ä", "Á∂ôÁ∂ö15ÊôÇÈñì‰ª•‰∏ä"];
                    exp = "2024Âπ¥4Êúà„Åã„Çâ„ÄÅ‰ºëÊÅØÊôÇÈñì„ÅØ„ÄéÁ∂ôÁ∂ö11ÊôÇÈñì‰ª•‰∏ä„Äè„ÅåÂü∫Êú¨„É´„Éº„É´„Åß„Åô„ÄÇ";
                }
                if (cat === "ÈÅì‰∫§Ê≥ï") {
                    text = "„Äê2024ÊîπÊ≠£„ÄëÂ§ßÂûãË≤®Áâ©Ëá™ÂãïËªä„ÅåÈ´òÈÄüÈÅìË∑Ø„ÅÆÊú¨Á∑öËªäÈÅì„ÅßÂá∫„Åõ„ÇãÊúÄÈ´òÈÄüÂ∫¶„ÅØÔºü";
                    opts = ["ÊôÇÈÄü90km", "ÊôÇÈÄü80km", "ÊôÇÈÄü100km", "ÊôÇÈÄü70km"];
                    exp = "2024Âπ¥4Êúà„Çà„Çä„ÄÅÂ§ßÂûãË≤®Áâ©„ÅÆÈ´òÈÄüÊúÄÈ´òÈÄüÂ∫¶„ÅØ80‚Üí90km/h„Å´Âºï„Åç‰∏ä„Åí„Çâ„Çå„Åæ„Åó„Åü„ÄÇ";
                }
                return { id, year: yr, category: cat, type: "single", text, options: opts, answer: [0], explanation: exp };
            });
        };

        const QUESTIONS = generateData();

        const App = () => {
            const [view, setView] = useState('home');
            const [currentQs, setCurrentQs] = useState([]);
            const [idx, setIdx] = useState(0);
            const [selected, setSelected] = useState([]);
            const [answered, setAnswered] = useState(false);
            const [stats, setStats] = useState(JSON.parse(localStorage.getItem('unkan_200_v1') || '{}'));

            useEffect(() => {
                localStorage.setItem('unkan_200_v1', JSON.stringify(stats));
            }, [stats]);

            const start = (mode, val) => {
                let qs = [...QUESTIONS];
                if (mode === 'random') qs = qs.sort(() => Math.random() - 0.5).slice(0, 10);
                if (mode === 'weak') qs = qs.filter(q => stats[q.id] && (stats[q.id].c / stats[q.id].t) < 0.6).slice(0, 10);
                if (mode === 'cat') qs = qs.filter(q => q.category === val);
                
                if (qs.length === 0) return alert("ÂØæË±°„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ");
                setCurrentQs(qs); setIdx(0); setSelected([]); setAnswered(false); setView('quiz');
            };

            if (view === 'home') return (
                <div className="max-w-md mx-auto min-h-screen p-6 pb-12">
                    <header className="py-10 text-center">
                        <h1 className="text-4xl font-black italic text-blue-600 leading-none">UN-KAN<br/><span className="text-gray-900 text-2xl not-italic">SPECIALIST 200</span></h1>
                        <div className="mt-2 text-[10px] font-bold tracking-widest text-gray-400 uppercase">2024 Law Revision Compliant</div>
                    </header>

                    <div className="grid grid-cols-2 gap-4 mb-10">
                        <button onClick={() => start('random')} className="bg-white p-6 rounded-3xl shadow-xl active:scale-95 transition-all flex flex-col items-center">
                            <span className="text-2xl mb-2">üé≤</span>
                            <span className="font-black text-xs">„É©„É≥„ÉÄ„É†10</span>
                        </button>
                        <button onClick={() => start('weak')} className="bg-white p-6 rounded-3xl shadow-xl active:scale-95 transition-all flex flex-col items-center border-b-4 border-red-500">
                            <span className="text-2xl mb-2">üß†</span>
                            <span className="font-black text-xs text-red-600">Ëã¶ÊâãÂÖãÊúç</span>
                        </button>
                    </div>

                    <div className="space-y-4">
                        <h2 className="text-xs font-black text-gray-400 uppercase tracking-widest mb-2">Category ÈÄ≤Êçó</h2>
                        {["Ë≤®Áâ©‰∫ãÊ•≠Ê≥ï", "Ëªä‰∏°Ê≥ï", "ÈÅì‰∫§Ê≥ï", "Âä¥Âü∫Ê≥ï", "ÂÆüÂãô"].map(cat => {
                            const cQs = QUESTIONS.filter(q => q.category === cat);
                            const solved = cQs.filter(q => stats[q.id]);
                            const score = solved.length ? Math.round((solved.filter(q => (stats[q.id].c/stats[q.id].t) >= 0.8).length / cQs.length) * 100) : 0;
                            return (
                                <div key={cat} onClick={() => start('cat', cat)} className="bg-white p-4 rounded-2xl shadow-sm flex items-center justify-between active:bg-blue-50">
                                    <span className="text-sm font-bold">{cat}</span>
                                    <div className="flex items-center gap-3">
                                        <div className="w-20 h-1.5 bg-gray-100 rounded-full overflow-hidden">
                                            <div className="h-full bg-blue-500" style={{width: `${score}%`}} />
                                        </div>
                                        <span className="text-[10px] font-mono text-gray-400">{score}%</span>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </div>
            );

            const q = currentQs[idx];
            const correct = JSON.stringify(selected.sort()) === JSON.stringify(q.answer.sort());

            return (
                <div className="max-w-md mx-auto min-h-screen bg-white flex flex-col p-6 animate-in fade-in">
                    <div className="flex justify-between items-center mb-6">
                        <button onClick={() => setView('home')} className="text-2xl text-gray-300 font-bold">‚úï</button>
                        <div className="h-1 flex-grow mx-4 bg-gray-100 rounded-full overflow-hidden">
                            <div className="h-full bg-blue-600 transition-all" style={{width: `${((idx+1)/currentQs.length)*100}%`}} />
                        </div>
                        <span className="text-[10px] font-black text-gray-400">{idx+1}/{currentQs.length}</span>
                    </div>

                    <div className="flex-grow overflow-y-auto">
                        <div className="flex gap-2 mb-2">
                            <span className="bg-gray-900 text-white text-[9px] font-black px-2 py-0.5 rounded">{q.year}</span>
                            <span className="text-blue-600 text-[9px] font-black tracking-widest uppercase">{q.category}</span>
                        </div>
                        <h2 className="text-xl font-bold leading-snug mb-8">{q.text}</h2>

                        <div className="space-y-3">
                            {q.options.map((opt, i) => (
                                <div key={i} onClick={() => !answered && setSelected([i])}
                                    className={`p-4 rounded-2xl border-2 transition-all ${selected.includes(i) ? (answered ? (q.answer.includes(i) ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50') : 'border-blue-600 bg-blue-50 shadow-lg') : (answered && q.answer.includes(i) ? 'border-green-500 bg-green-50' : 'border-gray-100')}`}>
                                    <div className="flex gap-3 text-sm font-bold">
                                        <span className="text-blue-600 font-black">{i+1}.</span> {opt}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="mt-8 safe-area-bottom">
                        {!answered ? (
                            <button disabled={selected.length === 0} onClick={() => {
                                setStats(prev => {
                                    const s = prev[q.id] || { c: 0, t: 0 };
                                    return { ...prev, [q.id]: { c: s.c + (correct ? 1 : 0), t: s.t + 1 } };
                                });
                                setAnswered(true);
                            }} className="w-full py-5 bg-gray-900 text-white rounded-3xl font-black shadow-2xl active:scale-95 transition-all disabled:opacity-10">ÂõûÁ≠î„ÇíÁ¢∫ÂÆö„Åô„Çã</button>
                        ) : (
                            <div className="animate-in slide-in-from-bottom-4">
                                <div className={`mb-4 flex items-center gap-2 font-black ${correct ? 'text-green-600' : 'text-red-600'}`}>
                                    <span>{correct ? '‚úÖ Ê≠£Ëß£ÔºÅ' : '‚ùå ‰∏çÊ≠£Ëß£'}</span>
                                </div>
                                <div className="p-4 bg-gray-50 rounded-2xl text-[11px] leading-relaxed mb-6 border border-gray-100">{q.explanation}</div>
                                <button onClick={() => idx < currentQs.length - 1 ? (setIdx(idx+1), setSelected([]), setAnswered(false)) : setView('home')} 
                                    className="w-full py-5 bg-blue-600 text-white rounded-3xl font-black shadow-lg">
                                    {idx === currentQs.length - 1 ? 'ÊºîÁøí„ÇíÁµÇ‰∫Ü„Åô„Çã' : 'Ê¨°„ÅÆÂïèÈ°å„Å∏'}
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
